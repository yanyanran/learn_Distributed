# GFS分布式文件系统论文总结

## 单机文件系统  -->  分布式文件系统

1、文件被分割成固定大小的Chunk来存储  
2、自动扩缩容的实现主要通过在master单点上增减，调整chunk的元数据  
3、锁定文件存储在哪台机器上：根据master中文件到chunk再到chunk位置的映射，定位到具体的chunkServer  
4、为了保证服务器在故障时文件不丢失不损坏：实现master的WAL日志和主备，chunk的多副本  
5、使用多副本后保持副本之间的一致性：GFS区分改写和追加这两个不同的写入模式，在串行/并行情况下设计不同的一致性  

## 分布式文件系统  -->  GFS  

6、采用更大的chunk的配套的一致性策略来支持大文件的存储  
7、超多机器情况下实现自动监控、容错和恢复：master的主备切换由chubby（一致性，同raft）负责，chunk的租约、副本位置和数量由master负责  
8、支持快速的顺序读和追加写：三写一读，用流水线技术+数据流与控制流分离技术保证性能

## Main Point
### 读文件

### 追加文件

### 一致性

### master容错
客户端发起操作会写到日志中去，master收到日志落盘后开始操作。发生错误后master重启，通过日志恢复。当日志量太大时为了快速启动，使用master定期快照。

### master设计
单server节点，元数据包括{1文件名和chunk空间，2文件和chunk的映射，3chunk到chunkServer的映射【不需要持久化】，4租约版本号（解决一致性问题）}
四个元数据里面只有【chunk副本】不需要做持久化，其他都需要存磁盘做持久化
【chunk副本】chunk启动chunkServer也要启动，master会扫描chunkServer，会扫描到对应的chunk，建立连接，加载数据到master中去。